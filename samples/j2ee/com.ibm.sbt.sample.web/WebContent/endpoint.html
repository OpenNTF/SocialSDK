<html>
<head>
</head>
<body>
	<button onClick="getProfile();">Get Profile</button><button onClick="publish();">Post Activity</button>
	<div id="data"></div>
	<script type="text/javascript" src="https://localhost:8443/sbt.dojo180/dojo/dojo.js" djConfig="parseOnLoad:true"></script>
	<script type="text/javascript" src="https://localhost:8443/sbt.sample.web/library?ver=1.8.0"></script>
	<script type="text/javascript">
	function publish(){
		require([ "sbt/config", "sbt/Endpoint", "sbt/dom", "sbt/json"], function(config,Endpoint,dom,json) {
		    
			// Post Data
			var postData = json.stringify({
				actor:{
					id:"@self"
				},
				generator:{
					id:1,
					displayName:"Synthesio",
					url:"http://amathieu.dev.synthesio.com/"
				},
				object:{
					id:123456,
					displayName:"Synthesio Verbatim",
					//summary:"Tweet from @me" +source +": " +decodeURIComponent(msg),
					summary: 'Hey it is me!',
					url:"http://amathieu.dev.synthesio.com/"
				},
				verb:"post",
			});
			
			// ActivityStream URL
			var url = "/connections/opensocial/oauth/rest/activitystreams/@me/@all";
		    
			// HTTP params
			var params = {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				data: postData
			};
		    
		    // Endpoint
		    var endpoint = config.findEndpoint("connectionsOA2");
		    endpoint.request(url, params).then(function(response){
		    	dom.setText('data', 'Success');
		    	console.debug(response);
		    }, function(error){
		    	dom.setText('data', 'Error');
		    	console.debug(error);
		    });
		});
	}


	function getProfile(){
		require([ "sbt/config", "sbt/Endpoint", "sbt/dom", "sbt/json"], function(config,Endpoint,dom,json) {
			
			// ActivityStream URL
			var url = "/connections/opensocial/oauth/rest/people/@me/";
		    
			// HTTP params
			var params = {
				method: 'GET'
			};
		    
		    // Endpoint
		    var endpoint = config.findEndpoint("connectionsOA2");
		    endpoint.request(url, params).then(function(response){
		    	dom.setText('data', 'Success');
		    	console.debug(response);
		    }, function(error){
		    	dom.setText('data', 'Error');
		    	console.debug(error);
		    });
		});
	};

	</script>
</body>
</html>